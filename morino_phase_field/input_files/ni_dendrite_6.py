import numpy as np
import taichi as ti


solutes     = ['AL', 'CO', 'CR', 'CU', 'FE']
uini_ave    = np.array([0.136, 0.01, 0.01, 0.003, 0.01])
yini_LIQUID = np.array([[0.13683426756373898, 0.009891306841157205, 0.010074579162775802, 0.0030460806791521946, 0.010192621355020155]])
yini_FCC_A1 = np.array([[0.12256504568289889, 0.011750382832794844, 0.008798985255994124, 0.002257921743874395, 0.006898046604841906]])
# solvent  : NI
# solutes  : ['AL', 'CO', 'CR', 'CU', 'FE']
# phases   : ['LIQUID', 'FCC_A1']

@ti.func
def GHSERAL(T):
    return -11278.378+188.684153*T-31.748192*T*ti.log(T)-1.231E+28*(1/T)**(9)

@ti.func
def GHSERCO(T):
    return +310.241+133.36601*T-25.0861*T*ti.log(T)-2.6547387E-3*T**2-1.7348E-07*T**3+72526.9*(1/T)**(1)

@ti.func
def GHSERCR(T):
    return -8856.94+157.48*T-26.908*T*ti.log(T)+0.00189435*T**2-1.47721E-6*T**3+139250*(1/T)**(1)

@ti.func
def GHSERCU(T):
    return -13542.026+183.803828*T-31.38*T*ti.log(T)+3.642E+29*(1/T)**(9)

@ti.func
def GHSERFE(T):
    return +1225.7+124.134*T-23.5143*T*ti.log(T)-0.00439752*T**2-5.89269E-8*T**3+77358.5*(1/T)**(1)

@ti.func
def GHSERMN(T):
    return -28733.41+312.2648*T-48.0*T*ti.log(T)+1.656847E+30*(1/T)**(9)

@ti.func
def GHSERMO(T):
    return -7746.302+131.9197*T-23.56414*T*ti.log(T)-0.003443396*T**2+5.662834E-7*T**3-1.309265E-10*T**4+65812.39*(1/T)**(1)

@ti.func
def GHSERNB(T):
    return -8519.353+142.045475*T-26.4711*T*ti.log(T)+0.203475E-3*T**2-0.35011E-6*T**3+93399*(1/T)**(1)

@ti.func
def GHSERNI(T):
    return -5179.159+117.854*T-22.096*T*ti.log(T)-4.8407E-3*T**2

@ti.func
def GHSERSI(T):
    return -8162.609+137.236859*T-22.8317533*T*ti.log(T)-1.912904E-3*T**2-0.003552E-6*T**3+176667*(1/T)**(1)

@ti.func
def GHSERTI(T):
    return +908.837+66.976538*T-14.9466*T*ti.log(T)-8.1465E-3*T**2+2.02715E-07*T**3-1477660*(1/T)**(1)

@ti.func
def GHSERVV(T):
    return -7967.842+143.291093*T-25.9*T*ti.log(T)+0.0625E-3*T**2-0.68E-6*T**3

@ti.func
def GHSERWW(T):
    return -7646.311+130.4*T-24.1*T*ti.log(T)-1.936E-3*T**2+2.07E-7*T**3-5.33E-11*T**4+44500*(1/T)**(1)

@ti.func
def GHSERZR(T):
    return -7827.595+125.64905*T-24.1618*T*ti.log(T)-4.37791E-3*T**2+34971*(1/T)**(1)

@ti.func
def GCOFCC(T):
    return +427.591-0.61525*T+GHSERCO(T)

@ti.func
def GHFFCC(T):
    return +3012.703+108.544*T-22.7075*T*ti.log(T)-0.004146*T**2-0.000477E-6*T**3-22590*(1/T)**(1)

@ti.func
def GZRFCC(T):
    return +7600-0.9*T+GHSERZR(T)

@ti.func
def GHEXTNB(T):
    return -8519.35+142.048*T-26.4711*T*ti.log(T)+0.203475E-3*T**2-0.350119E-6*T**3+93398.8*(1/T)**(1)

@ti.func
def LF0(T):
    return -20455.7462-11.7930695*T

@ti.func
def LF1(T):
    return +15581.5125-8.49116947*T


@ti.func
def f_LIQUID(T:float,AL1:float,CO1:float,CR1:float,CU1:float,FE1:float) -> float:
    NI1 = (1.0-AL1-CO1-CR1-CU1-FE1)
    return 1/1.0*(+ \
           + 8.3145*T*( +1.0*(+(AL1)*ti.log(AL1) +(CO1)*ti.log(CO1) +(CR1)*ti.log(CR1) +(CU1)*ti.log(CU1) +(FE1)*ti.log(FE1) +(NI1)*ti.log(NI1) ) )+ \
           + AL1                                       *(+10482.382-11.253974*T+1.231E+28*(1/T)**(9)+GHSERAL(T))+ \
           + CO1                                       *(+15085.037-8.931932*T-2.19801E-21*T**(7)+GHSERCO(T))+ \
           + CR1                                       *(+24339.955-11.420225*T+2.37615E-21*T**7+GHSERCR(T))+ \
           + CU1                                       *(+13495.481-9.922344*T-3.642E+29*(1/T)**(9)+GHSERCU(T))+ \
           + FE1                                       *(+12040.17-6.55843*T-3.6751551E-21*T**7+GHSERFE(T))+ \
           + NI1                                       *(+16414.686-9.397*T-3.82318E-21*T**7+GHSERNI(T))+ \
           + AL1*CO1                                   *(-157700+30.4*T)+ \
           + AL1*CO1*(AL1-CO1)                         *(-2600)+ \
           + AL1*CO1*(AL1-CO1)**2                      *(+11600)+ \
           + AL1*CO1*(AL1-CO1)**3                      *(+3250+1.735*T)+ \
           + AL1*CR1                                   *(-29000)+ \
           + AL1*CR1*(AL1-CR1)                         *(-11000)+ \
           + AL1*CU1                                   *(-66622+8.1*T)+ \
           + AL1*CU1*(AL1-CU1)                         *(+46800-90.8*T+10*T*ti.log(T))+ \
           + AL1*CU1*(AL1-CU1)**2                      *(-2812)+ \
           + AL1*FE1                                   *(-91976.5+22.1314*T)+ \
           + AL1*FE1*(AL1-FE1)                         *(-5672.58+4.8728*T)+ \
           + AL1*FE1*(AL1-FE1)**2                      *(+121.9)+ \
           + AL1*NI1                                   *(-207109.28+41.31501*T)+ \
           + AL1*NI1*(AL1-NI1)                         *(-10185.79+5.8714*T)+ \
           + AL1*NI1*(AL1-NI1)**2                      *(+81204.81-31.95713*T)+ \
           + AL1*NI1*(AL1-NI1)**3                      *(+4365.35-2.51632*T)+ \
           + AL1*NI1*(AL1-NI1)**4                      *(-22101.64+13.16341*T)+ \
           + CO1*CR1                                   *(-3034-5.624*T)+ \
           + CO1*CR1*(CO1-CR1)                         *(+909)+ \
           + CO1*CU1                                   *(+35200-4.945*T)+ \
           + CO1*CU1*(CO1-CU1)                         *(-1000+0.083*T)+ \
           + CO1*FE1                                   *(-9753.82)+ \
           + CO1*FE1*(CO1-FE1)**2                      *(+2757.96)+ \
           + CO1*NI1                                   *(+1331)+ \
           + CR1*CU1                                   *(+62797.75-18.95186*T)+ \
           + CR1*CU1*(CR1-CU1)                         *(+1183.91)+ \
           + CR1*FE1                                   *(-17737+7.996546*T)+ \
           + CR1*FE1*(CR1-FE1)                         *(-1331)+ \
           + CR1*NI1                                   *(+318-7.3318*T)+ \
           + CR1*NI1*(CR1-NI1)                         *(+16941-6.3696*T)+ \
           + CU1*FE1                                   *(+73316.72-142.79*T+15.82*T*ti.log(T))+ \
           + CU1*FE1*(CU1-FE1)                         *(+9100.15-5.94*T)+ \
           + CU1*FE1*(CU1-FE1)**2                      *(+2428.96)+ \
           + CU1*FE1*(CU1-FE1)**3                      *(-233.62)+ \
           + CU1*NI1                                   *(+11760+1.084*T)+ \
           + CU1*NI1*(CU1-NI1)                         *(-1672)+ \
           + FE1*NI1                                   *(-16911+5.1622*T)+ \
           + FE1*NI1*(FE1-NI1)                         *(+10180-4.146656*T)+ \
           + AL1*CO1*CR1                               *(-25000)+ \
           + AL1*CO1*NI1                               *(+30000)+ \
           + AL1*CR1*NI1                               *(+16000)+ \
           + AL1*FE1*NI1*(AL1+(1/3)*(1-(AL1+FE1+NI1))) *(-306100+180*T)+ \
           + AL1*FE1*NI1*(FE1+(1/3)*(1-(AL1+FE1+NI1))) *(+416900-120*T)+ \
           + AL1*FE1*NI1*(NI1+(1/3)*(1-(AL1+FE1+NI1))) *(+14790-6.7*T)+ \
           + CO1*CR1*NI1*(CO1+(1/3)*(1-(CO1+CR1+NI1))) *(+1E-8)+ \
           + CO1*CR1*NI1*(CR1+(1/3)*(1-(CO1+CR1+NI1))) *(+1E-8)+ \
           + CO1*CR1*NI1*(NI1+(1/3)*(1-(CO1+CR1+NI1))) *(+1E-8)+ \
           + CO1*FE1*NI1                               *(+50000)+ \
           + CR1*CU1*FE1                               *(+40000)+ \
           + CR1*FE1*NI1*(CR1+(1/3)*(1-(CR1+FE1+NI1))) *(+13022)+ \
           + CR1*FE1*NI1*(FE1+(1/3)*(1-(CR1+FE1+NI1))) *(+13177)+ \
           + CR1*FE1*NI1*(NI1+(1/3)*(1-(CR1+FE1+NI1))) *(+3313)+ \
           + CU1*FE1*NI1                               *(-68786+30.9*T) )

@ti.func
def fyy_LIQUID_AL1(T:float,AL1:float,CO1:float,CR1:float,CU1:float,FE1:float) -> float:
    fyy_AL1 = 3.0*AL1*CO1*(2*AL1 - 2*CO1)*(1.735*T + 3250) + 23200.0*AL1*CO1 - 5624.0*AL1*CU1 + 2.0*AL1*FE1*(14790 - 6.7*T) - 2.0*AL1*FE1*(180*T - 306100) + 243.8*AL1*FE1 + 24.0*AL1*(4365.35 - 2.51632*T)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0)*(2*AL1 + CO1 + CR1 + CU1 + FE1 - 1.0) - 48.0*AL1*(4365.35 - 2.51632*T)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5)**2 + 8.0*AL1*(81204.81 - 31.95713*T)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0) - 8.0*AL1*(81204.81 - 31.95713*T)*(2*AL1 + CO1 + CR1 + CU1 + FE1 - 1.0) - 4.0*AL1*(5.8714*T - 10185.79) + 192.0*AL1*(13.16341*T - 22101.64)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5)**2 - 128.0*AL1*(13.16341*T - 22101.64)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5)**3 + 6.0*CO1*(AL1 - CO1)**2*(1.735*T + 3250) + 23200.0*CO1*(2*AL1 - 2*CO1) - 65200.0*CO1 - 13048.6666666667*CR1*FE1 - 2.0*CR1*(16941 - 6.3696*T) - 54000.0*CR1 - 5624.0*CU1*(2*AL1 - 2*CU1) + 2.0*CU1*(10*T*ti.log(T) - 90.8*T + 46800) + 3344.0*CU1 - 2.0*FE1*(10180 - 4.146656*T) - 2.0*FE1*(14790 - 6.7*T)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0) - 2.0*FE1*(14790 - 6.7*T)*(-AL1 - 2*CO1/3 - 2*CR1/3 - 2*CU1/3 - FE1 + 1.0) - 2.0*FE1*(416900 - 120*T)*(CO1/3 + CR1/3 + CU1/3 + FE1) + 243.8*FE1*(2*AL1 - 2*FE1) + 2.0*FE1*(4.8728*T - 5672.58) - 2.0*FE1*(180*T - 306100)*(AL1 + CO1/3 + CR1/3 + CU1/3) + 2.0*FE1*(180*T - 306100)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0) + 8.3145*T*(1.0/(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0) + 1.0/AL1) - 82.63002*T + 24.0*(4365.35 - 2.51632*T)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5)**2 - 8.0*(4365.35 - 2.51632*T)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5)**3 + 3*(34922.8 - 20.13056*T)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5)**2 - (34922.8 - 20.13056*T)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5)**3 + 4.0*(81204.81 - 31.95713*T)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0)*(2*AL1 + CO1 + CR1 + CU1 + FE1 - 1.0) - 4.0*(81204.81 - 31.95713*T)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5)**2 + (324819.24 - 127.82852*T)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0)*(2*AL1 + CO1 + CR1 + CU1 + FE1 - 1.0) - (324819.24 - 127.82852*T)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5)**2 + 4.0*(5.8714*T - 10185.79)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0) - 2.0*(5.8714*T - 10185.79)*(2*AL1 + CO1 + CR1 + CU1 + FE1 - 1.0) + 64.0*(13.16341*T - 22101.64)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5)**3 - 16.0*(13.16341*T - 22101.64)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5)**4 + 4*(210.61456*T - 353626.24)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5)**3 - (210.61456*T - 353626.24)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5)**4 + 414218.56
    return fyy_AL1
@ti.func
def fyy_LIQUID_CO1(T:float,AL1:float,CO1:float,CR1:float,CU1:float,FE1:float) -> float:
    fyy_CO1 = -3.0*AL1*CO1*(-2*AL1 + 2*CO1)*(1.735*T + 3250) + 23200.0*AL1*CO1 + 1.33333333333333*AL1*FE1*(14790 - 6.7*T) - 0.666666666666666*AL1*FE1*(416900 - 120*T) - 0.666666666666666*AL1*FE1*(180*T - 306100) + 12.0*AL1*(4365.35 - 2.51632*T)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5) - 24.0*AL1*(4365.35 - 2.51632*T)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5)**2 + 2.0*AL1*(81204.81 - 31.95713*T)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0) - 8.0*AL1*(81204.81 - 31.95713*T)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5) + 23200.0*AL1*(-2*AL1 + 2*CO1) - 6.0*AL1*(AL1 - CO1)**2*(1.735*T + 3250) - 2.0*AL1*(5.8714*T - 10185.79) + 48.0*AL1*(13.16341*T - 22101.64)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5)**2 - 64.0*AL1*(13.16341*T - 22101.64)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5)**3 - 54800.0*AL1 + 5515.92*CO1*FE1 - 13048.6666666667*CR1*FE1 - 2.0*CR1*(16941 - 6.3696*T) - 2.0e-8*CR1*(AL1/3 + CO1 + CU1/3 + FE1/3) - 2.0e-8*CR1*(AL1/3 + CR1 + CU1/3 + FE1/3) - 2.0e-8*CR1*(-2*AL1/3 - CO1 - CR1 - 2*CU1/3 - 2*FE1/3 + 1.0) + 1818.0*CR1 + 2.0*CU1*(0.083*T - 1000) + 3344.0*CU1 - 2.0*FE1*(10180 - 4.146656*T) + 5515.92*FE1*(2*CO1 - 2*FE1) - 100000.0*FE1 + 8.3145*T*(1.0/(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0) + 1.0/CO1) - 2662.0
    return fyy_CO1
@ti.func
def fyy_LIQUID_CR1(T:float,AL1:float,CO1:float,CR1:float,CU1:float,FE1:float) -> float:
    fyy_CR1 = 1.33333333333333*AL1*FE1*(14790 - 6.7*T) - 0.666666666666666*AL1*FE1*(416900 - 120*T) - 0.666666666666666*AL1*FE1*(180*T - 306100) + 12.0*AL1*(4365.35 - 2.51632*T)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5) - 24.0*AL1*(4365.35 - 2.51632*T)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5)**2 + 2.0*AL1*(81204.81 - 31.95713*T)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0) - 8.0*AL1*(81204.81 - 31.95713*T)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5) - 2.0*AL1*(5.8714*T - 10185.79) + 48.0*AL1*(13.16341*T - 22101.64)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5)**2 - 64.0*AL1*(13.16341*T - 22101.64)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5)**3 - 10000.0*AL1 - 2.0e-8*CO1*(AL1/3 + CO1 + CU1/3 + FE1/3) - 2.0e-8*CO1*(AL1/3 + CR1 + CU1/3 + FE1/3) - 2.0e-8*CO1*(-2*AL1/3 - CO1 - CR1 - 2*CU1/3 - 2*FE1/3 + 1.0) - 1818.0*CO1 - 19418.0*CR1*FE1 - 4.0*CR1*(16941 - 6.3696*T) + 5711.82*CU1 - 2.0*FE1*(10180 - 4.146656*T) - 26044.0*FE1*(AL1/3 + CO1/3 + CR1 + CU1/3) - 26354.0*FE1*(AL1/3 + CO1/3 + CU1/3 + FE1) + 19418.0*FE1*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0) - 6626.0*FE1*(-2*AL1/3 - 2*CO1/3 - CR1 - 2*CU1/3 - FE1 + 1.0) - 2662.0*FE1 + 8.3145*T*(1.0/(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0) + 1.0/CR1) + 14.6636*T + 2.0*(16941 - 6.3696*T)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0) - 1.0*(16941 - 6.3696*T)*(AL1 + CO1 + 2*CR1 + CU1 + FE1 - 1.0) + 2*(16941.0 - 6.3696*T)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0) - (16941.0 - 6.3696*T)*(AL1 + CO1 + 2*CR1 + CU1 + FE1 - 1.0) - 636.0
    return fyy_CR1
@ti.func
def fyy_LIQUID_CU1(T:float,AL1:float,CO1:float,CR1:float,CU1:float,FE1:float) -> float:
    fyy_CU1 = -5624.0*AL1*CU1 + 1.33333333333333*AL1*FE1*(14790 - 6.7*T) - 0.666666666666666*AL1*FE1*(416900 - 120*T) - 0.666666666666666*AL1*FE1*(180*T - 306100) + 12.0*AL1*(4365.35 - 2.51632*T)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5) - 24.0*AL1*(4365.35 - 2.51632*T)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5)**2 + 2.0*AL1*(81204.81 - 31.95713*T)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0) - 8.0*AL1*(81204.81 - 31.95713*T)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5) - 5624.0*AL1*(-2*AL1 + 2*CU1) - 2.0*AL1*(5.8714*T - 10185.79) + 48.0*AL1*(13.16341*T - 22101.64)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5)**2 - 64.0*AL1*(13.16341*T - 22101.64)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5)**3 - 2.0*AL1*(10*T*ti.log(T) - 90.8*T + 46800) + 10032.0*AL1 - 2.0*CO1*(0.083*T - 1000) + 10032.0*CO1 - 13048.6666666667*CR1*FE1 - 2.0*CR1*(16941 - 6.3696*T) + 7664.18*CR1 - 700.86*CU1*FE1*(2*CU1 - 2*FE1) + 4857.92*CU1*FE1 + 20064.0*CU1 + 2.0*FE1*(9100.15 - 5.94*T) - 2.0*FE1*(10180 - 4.146656*T) - 1401.72*FE1*(CU1 - FE1)**2 + 4857.92*FE1*(2*CU1 - 2*FE1) - 2.0*FE1*(30.9*T - 68786) + 10032.0*FE1 + 8.3145*T*(1.0/(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0) + 1.0/CU1) - 2.168*T - 33552.0
    return fyy_CU1
@ti.func
def fyy_LIQUID_FE1(T:float,AL1:float,CO1:float,CR1:float,CU1:float,FE1:float) -> float:
    fyy_FE1 = 2.0*AL1*FE1*(14790 - 6.7*T) - 2.0*AL1*FE1*(416900 - 120*T) + 243.8*AL1*FE1 + 12.0*AL1*(4365.35 - 2.51632*T)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5) - 24.0*AL1*(4365.35 - 2.51632*T)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5)**2 - 2.0*AL1*(14790 - 6.7*T)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0) - 2.0*AL1*(14790 - 6.7*T)*(-AL1 - 2*CO1/3 - 2*CR1/3 - 2*CU1/3 - FE1 + 1.0) + 2.0*AL1*(81204.81 - 31.95713*T)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0) - 8.0*AL1*(81204.81 - 31.95713*T)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5) - 2.0*AL1*(416900 - 120*T)*(CO1/3 + CR1/3 + CU1/3 + FE1) + 2.0*AL1*(416900 - 120*T)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0) + 243.8*AL1*(-2*AL1 + 2*FE1) - 2.0*AL1*(4.8728*T - 5672.58) - 2.0*AL1*(5.8714*T - 10185.79) + 48.0*AL1*(13.16341*T - 22101.64)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5)**2 - 64.0*AL1*(13.16341*T - 22101.64)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5)**3 - 2.0*AL1*(180*T - 306100)*(AL1 + CO1/3 + CR1/3 + CU1/3) + 5515.92*CO1*FE1 + 5515.92*CO1*(-2*CO1 + 2*FE1) - 100000.0*CO1 - 19728.0*CR1*FE1 - 2.0*CR1*(16941 - 6.3696*T) - 26044.0*CR1*(AL1/3 + CO1/3 + CR1 + CU1/3) - 26354.0*CR1*(AL1/3 + CO1/3 + CU1/3 + FE1) + 19728.0*CR1*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0) - 6626.0*CR1*(-2*AL1/3 - 2*CO1/3 - CR1 - 2*CU1/3 - FE1 + 1.0) + 2662.0*CR1 + 700.86*CU1*FE1*(-2*CU1 + 2*FE1) + 4857.92*CU1*FE1 - 2.0*CU1*(9100.15 - 5.94*T) + 4857.92*CU1*(-2*CU1 + 2*FE1) + 1401.72*CU1*(CU1 - FE1)**2 - 2.0*CU1*(30.9*T - 68786) + 3344.0*CU1 - 4.0*FE1*(10180 - 4.146656*T) + 8.3145*T*(1.0/(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0) + 1.0/FE1) - 10.3244*T + 2*(10180.0 - 4.146656*T)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0) - (10180.0 - 4.146656*T)*(AL1 + CO1 + CR1 + CU1 + 2*FE1 - 1.0) + 2.0*(10180 - 4.146656*T)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0) - 1.0*(10180 - 4.146656*T)*(AL1 + CO1 + CR1 + CU1 + 2*FE1 - 1.0) + 33822.0
    return fyy_FE1

@ti.func
def f_FCC_A1(T:float,AL1:float,CO1:float,CR1:float,CU1:float,FE1:float) -> float:
    NI1 = (1.0-AL1-CO1-CR1-CU1-FE1)
    return 1/1.0*(+ \
           + 8.3145*T*( +1.0*(+(AL1)*ti.log(AL1) +(CO1)*ti.log(CO1) +(CR1)*ti.log(CR1) +(CU1)*ti.log(CU1) +(FE1)*ti.log(FE1) +(NI1)*ti.log(NI1) ) )+ \
           + AL1                                       *(+GHSERAL(T))+ \
           + CO1                                       *(+GCOFCC(T))+ \
           + CR1                                       *(+7284+0.163*T+GHSERCR(T))+ \
           + CU1                                       *(+GHSERCU(T))+ \
           + FE1                                       *(-1462.4+8.282*T-1.15*T*ti.log(T)+0.00064*T**2+GHSERFE(T))+ \
           + NI1                                       *(+GHSERNI(T))+ \
           + AL1*CO1                                   *(-105000)+ \
           + AL1*CR1                                   *(-45900+6*T)+ \
           + AL1*CU1                                   *(-53520+2*T)+ \
           + AL1*CU1*(AL1-CU1)                         *(+38590-2*T)+ \
           + AL1*CU1*(AL1-CU1)**2                      *(+1170)+ \
           + AL1*FE1                                   *(-76066.1+18.6758*T)+ \
           + AL1*FE1*(AL1-FE1)                         *(+21167.4+1.3398*T)+ \
           + AL1*NI1                                   *(-162407.75+16.212965*T)+ \
           + AL1*NI1*(AL1-NI1)                         *(+73417.798-34.914168*T)+ \
           + AL1*NI1*(AL1-NI1)**2                      *(+33471.014-9.8373558*T)+ \
           + AL1*NI1*(AL1-NI1)**3                      *(-30758.01+10.25267*T)+ \
           + CO1*CR1                                   *(+1500-9.592*T)+ \
           + CO1*CU1                                   *(+40900-5.5*T)+ \
           + CO1*CU1*(CO1-CU1)                         *(-1600)+ \
           + CO1*CU1*(CO1-CU1)**2                      *(-6900)+ \
           + CO1*FE1                                   *(-8968.75)+ \
           + CO1*FE1*(CO1-FE1)**2                      *(+3528.8)+ \
           + CO1*NI1                                   *(-800+1.2629*T)+ \
           + CR1*CU1                                   *(+88112-30.38315*T)+ \
           + CR1*FE1                                   *(+10833-7.477*T)+ \
           + CR1*FE1*(CR1-FE1)                         *(+1410)+ \
           + CR1*NI1                                   *(+8030-12.8801*T)+ \
           + CR1*NI1*(CR1-NI1)                         *(+33080-16.0362*T)+ \
           + CU1*FE1                                   *(+48885.74-11.51*T)+ \
           + CU1*FE1*(CU1-FE1)                         *(+12687.16-8.01*T)+ \
           + CU1*FE1*(CU1-FE1)**2                      *(+4054.11)+ \
           + CU1*NI1                                   *(+8047.72+3.42217*T)+ \
           + CU1*NI1*(CU1-NI1)                         *(-2041.3+0.99714*T)+ \
           + FE1*NI1                                   *(-12054.355+3.27413*T)+ \
           + FE1*NI1*(FE1-NI1)                         *(+11082.1315-4.45077*T)+ \
           + FE1*NI1*(FE1-NI1)**2                      *(-725.805174)+ \
           + AL1*CO1*NI1                               *(-7500+5*T)+ \
           + AL1*CR1*NI1                               *(+30300)+ \
           + AL1*FE1*NI1*(AL1+(1/3)*(1-(AL1+FE1+NI1))) *(+1E-8)+ \
           + AL1*FE1*NI1*(FE1+(1/3)*(1-(AL1+FE1+NI1))) *(-77900)+ \
           + AL1*FE1*NI1*(NI1+(1/3)*(1-(AL1+FE1+NI1))) *(+58000)+ \
           + CO1*CR1*NI1                               *(-20000+10*T)+ \
           + CR1*CU1*FE1*(CR1+(1/3)*(1-(CR1+CU1+FE1))) *(+1E-7)+ \
           + CR1*CU1*FE1*(CU1+(1/3)*(1-(CR1+CU1+FE1))) *(+350000)+ \
           + CR1*CU1*FE1*(FE1+(1/3)*(1-(CR1+CU1+FE1))) *(+30000)+ \
           + CR1*FE1*NI1                               *(+1618)+ \
           + CU1*FE1*NI1                               *(-73272+30.9*T) )

@ti.func
def fyy_FCC_A1_AL1(T:float,AL1:float,CO1:float,CR1:float,CU1:float,FE1:float) -> float:
    fyy_AL1 = 2340.0*AL1*CU1 + 115999.99999998*AL1*FE1 + 8.0*AL1*(33471.014 - 9.8373558*T)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0) - 8.0*AL1*(33471.014 - 9.8373558*T)*(2*AL1 + CO1 + CR1 + CU1 + FE1 - 1.0) - 4.0*AL1*(73417.798 - 34.914168*T) + 24.0*AL1*(10.25267*T - 30758.01)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0)*(2*AL1 + CO1 + CR1 + CU1 + FE1 - 1.0) - 48.0*AL1*(10.25267*T - 30758.01)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5)**2 - 2.0*CO1*(5*T - 7500) - 2.0*CR1*(33080 - 16.0362*T) - 60600.0*CR1 + 2.0*CU1*(38590 - 2*T) + 2340.0*CU1*(2*AL1 - 2*CU1) - 2.0*CU1*(0.99714*T - 2041.3) - 2.0*FE1*(11082.1315 - 4.45077*T) + 2.0*FE1*(1.3398*T + 21167.4) - 2.0e-8*FE1*(AL1 + CO1/3 + CR1/3 + CU1/3) + 155800.0*FE1*(CO1/3 + CR1/3 + CU1/3 + FE1) - 117451.61034798*FE1*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0) - 116000.0*FE1*(-AL1 - 2*CO1/3 - 2*CR1/3 - 2*CU1/3 - FE1 + 1.0) + 5806.441392*FE1*(AL1/2 + CO1/2 + CR1/2 + CU1/2 + FE1 - 0.5) + 8.3145*T*(1.0/(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0) + 1.0/AL1) - 32.42593*T + 4.0*(33471.014 - 9.8373558*T)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0)*(2*AL1 + CO1 + CR1 + CU1 + FE1 - 1.0) - 4.0*(33471.014 - 9.8373558*T)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5)**2 + 4.0*(73417.798 - 34.914168*T)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0) - 2.0*(73417.798 - 34.914168*T)*(2*AL1 + CO1 + CR1 + CU1 + FE1 - 1.0) + (133884.056 - 39.3494232*T)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0)*(2*AL1 + CO1 + CR1 + CU1 + FE1 - 1.0) - (133884.056 - 39.3494232*T)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5)**2 + 24.0*(10.25267*T - 30758.01)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5)**2 - 8.0*(10.25267*T - 30758.01)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5)**3 + 3*(82.02136*T - 246064.08)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5)**2 - (82.02136*T - 246064.08)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5)**3 + 324815.5
    return fyy_AL1
@ti.func
def fyy_FCC_A1_CO1(T:float,AL1:float,CO1:float,CR1:float,CU1:float,FE1:float) -> float:
    fyy_CO1 = 129266.66666666*AL1*FE1 + 2.0*AL1*(33471.014 - 9.8373558*T)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0) - 8.0*AL1*(33471.014 - 9.8373558*T)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5) - 2.0*AL1*(73417.798 - 34.914168*T) - 2.0*AL1*(5*T - 7500) + 12.0*AL1*(10.25267*T - 30758.01)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5) - 24.0*AL1*(10.25267*T - 30758.01)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5)**2 - 13800.0*CO1*CU1 + 7057.6*CO1*FE1 - 2.0*CR1*(33080 - 16.0362*T) - 2.0*CR1*(10*T - 20000) - 13800.0*CU1*(2*CO1 - 2*CU1) - 2.0*CU1*(0.99714*T - 2041.3) - 3200.0*CU1 - 2.0*FE1*(11082.1315 - 4.45077*T) + 7057.6*FE1*(2*CO1 - 2*FE1) - 1451.610348*FE1*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0) + 5806.441392*FE1*(AL1/2 + CO1/2 + CR1/2 + CU1/2 + FE1 - 0.5) + 8.3145*T*(1.0/(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0) + 1.0/CO1) - 2.5258*T + 1600.0
    return fyy_CO1
@ti.func
def fyy_FCC_A1_CR1(T:float,AL1:float,CO1:float,CR1:float,CU1:float,FE1:float) -> float:
    fyy_CR1 = 129266.66666666*AL1*FE1 + 2.0*AL1*(33471.014 - 9.8373558*T)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0) - 8.0*AL1*(33471.014 - 9.8373558*T)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5) - 2.0*AL1*(73417.798 - 34.914168*T) + 12.0*AL1*(10.25267*T - 30758.01)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5) - 24.0*AL1*(10.25267*T - 30758.01)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5)**2 - 60600.0*AL1 - 2.0*CO1*(10*T - 20000) - 4.0*CR1*(33080 - 16.0362*T) - 253333.3333332*CU1*FE1 - 2.0*CU1*(0.99714*T - 2041.3) - 2.0*FE1*(11082.1315 - 4.45077*T) - 1451.610348*FE1*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0) + 5806.441392*FE1*(AL1/2 + CO1/2 + CR1/2 + CU1/2 + FE1 - 0.5) - 416.0*FE1 + 8.3145*T*(1.0/(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0) + 1.0/CR1) + 25.7602*T + 2*(33080.0 - 16.0362*T)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0) - (33080.0 - 16.0362*T)*(AL1 + CO1 + 2*CR1 + CU1 + FE1 - 1.0) + 2.0*(33080 - 16.0362*T)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0) - 1.0*(33080 - 16.0362*T)*(AL1 + CO1 + 2*CR1 + CU1 + FE1 - 1.0) - 16060.0
    return fyy_CR1
@ti.func
def fyy_FCC_A1_CU1(T:float,AL1:float,CO1:float,CR1:float,CU1:float,FE1:float) -> float:
    fyy_CU1 = 2340.0*AL1*CU1 + 129266.66666666*AL1*FE1 + 2.0*AL1*(33471.014 - 9.8373558*T)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0) - 8.0*AL1*(33471.014 - 9.8373558*T)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5) - 2.0*AL1*(38590 - 2*T) - 2.0*AL1*(73417.798 - 34.914168*T) + 2340.0*AL1*(-2*AL1 + 2*CU1) + 12.0*AL1*(10.25267*T - 30758.01)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5) - 24.0*AL1*(10.25267*T - 30758.01)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5)**2 - 13800.0*CO1*CU1 - 13800.0*CO1*(-2*CO1 + 2*CU1) + 3200.0*CO1 + 446666.6666666*CR1*FE1 - 2.0*CR1*(33080 - 16.0362*T) + 8108.22*CU1*FE1 - 4.0*CU1*(0.99714*T - 2041.3) - 2.0*FE1*(11082.1315 - 4.45077*T) + 2.0*FE1*(12687.16 - 8.01*T) + 8108.22*FE1*(2*CU1 - 2*FE1) - 2.0*FE1*(30.9*T - 73272) - 1451.610348*FE1*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0) + 5806.441392*FE1*(AL1/2 + CO1/2 + CR1/2 + CU1/2 + FE1 - 0.5) + 8.3145*T*(1.0/(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0) + 1.0/CU1) - 6.84434*T + 4.0*(0.99714*T - 2041.3)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0) - 2.0*(0.99714*T - 2041.3)*(AL1 + CO1 + CR1 + 2*CU1 + FE1 - 1.0) - 16095.44
    return fyy_CU1
@ti.func
def fyy_FCC_A1_FE1(T:float,AL1:float,CO1:float,CR1:float,CU1:float,FE1:float) -> float:
    fyy_FE1 = 271800.0*AL1*FE1 + 2.0*AL1*(33471.014 - 9.8373558*T)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0) - 8.0*AL1*(33471.014 - 9.8373558*T)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5) - 2.0*AL1*(73417.798 - 34.914168*T) - 2.0*AL1*(1.3398*T + 21167.4) + 12.0*AL1*(10.25267*T - 30758.01)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5) - 24.0*AL1*(10.25267*T - 30758.01)*(AL1 + CO1/2 + CR1/2 + CU1/2 + FE1/2 - 0.5)**2 - 2.0e-8*AL1*(AL1 + CO1/3 + CR1/3 + CU1/3) + 155800.0*AL1*(CO1/3 + CR1/3 + CU1/3 + FE1) - 271800.0*AL1*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0) - 116000.0*AL1*(-AL1 - 2*CO1/3 - 2*CR1/3 - 2*CU1/3 - FE1 + 1.0) + 7057.6*CO1*FE1 + 7057.6*CO1*(-2*CO1 + 2*FE1) - 193333.3333334*CR1*CU1 - 2.0*CR1*(33080 - 16.0362*T) - 6056.0*CR1 + 8108.22*CU1*FE1 - 2.0*CU1*(12687.16 - 8.01*T) + 8108.22*CU1*(-2*CU1 + 2*FE1) - 2.0*CU1*(0.99714*T - 2041.3) - 2.0*CU1*(30.9*T - 73272) - 4.0*FE1*(11082.1315 - 4.45077*T) - 5806.441392*FE1*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0) + 5806.441392*FE1*(AL1 + CO1 + CR1 + CU1 + 2*FE1 - 1.0) + 8.3145*T*(1.0/(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0) + 1.0/FE1) - 6.54826*T + 4.0*(11082.1315 - 4.45077*T)*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0) - 2.0*(11082.1315 - 4.45077*T)*(AL1 + CO1 + CR1 + CU1 + 2*FE1 - 1.0) - (-2903.220696*AL1 - 2903.220696*CO1 - 2903.220696*CR1 - 2903.220696*CU1 - 2903.220696*FE1 + 2903.220696)*(AL1 + CO1 + CR1 + CU1 + 2*FE1 - 1.0) - 2903.220696*(-AL1 - CO1 - CR1 - CU1 - FE1 + 1.0)*(AL1 + CO1 + CR1 + CU1 + 2*FE1 - 1.0) + 5806.441392*(AL1/2 + CO1/2 + CR1/2 + CU1/2 + FE1 - 0.5)**2 + 24108.71
    return fyy_FE1

@ti.func
def cal_f(i:int,T:float,y:float) -> float:
    f = 0.0
    if   i == 0: f = f_LIQUID(T,y[0,0],y[0,1],y[0,2],y[0,3],y[0,4])
    elif i == 1: f = f_FCC_A1(T,y[1,0],y[1,1],y[1,2],y[1,3],y[1,4])
    return f

@ti.func
def cal_fyy(a:int,j:int,T:float,y:float) -> float:
    fyy = 0.0
    if   a == 0: # if sublattice 1 in LIQUID
        if   j == 0: fyy = fyy_LIQUID_AL1(T,y[0,0],y[0,1],y[0,2],y[0,3],y[0,4])
        elif j == 1: fyy = fyy_LIQUID_CO1(T,y[0,0],y[0,1],y[0,2],y[0,3],y[0,4])
        elif j == 2: fyy = fyy_LIQUID_CR1(T,y[0,0],y[0,1],y[0,2],y[0,3],y[0,4])
        elif j == 3: fyy = fyy_LIQUID_CU1(T,y[0,0],y[0,1],y[0,2],y[0,3],y[0,4])
        elif j == 4: fyy = fyy_LIQUID_FE1(T,y[0,0],y[0,1],y[0,2],y[0,3],y[0,4])
    elif a == 1: # if sublattice 1 in FCC_A1
        if   j == 0: fyy = fyy_FCC_A1_AL1(T,y[1,0],y[1,1],y[1,2],y[1,3],y[1,4])
        elif j == 1: fyy = fyy_FCC_A1_CO1(T,y[1,0],y[1,1],y[1,2],y[1,3],y[1,4])
        elif j == 2: fyy = fyy_FCC_A1_CR1(T,y[1,0],y[1,1],y[1,2],y[1,3],y[1,4])
        elif j == 3: fyy = fyy_FCC_A1_CU1(T,y[1,0],y[1,1],y[1,2],y[1,3],y[1,4])
        elif j == 4: fyy = fyy_FCC_A1_FE1(T,y[1,0],y[1,1],y[1,2],y[1,3],y[1,4])
    return fyy

